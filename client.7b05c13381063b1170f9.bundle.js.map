{"version":3,"sources":["webpack:///./src/services/game/consts.ts","webpack:///./src/theme/theme.ts","webpack:///./src/services/game/selectors.ts","webpack:///./src/services/game/state.ts","webpack:///./src/services/game/utils.ts","webpack:///./src/services/game/reducer/ai-move.ts","webpack:///./src/services/game/actions/place-token.ts","webpack:///./src/services/game/win-lines.ts","webpack:///./src/services/game/actions/reset.ts","webpack:///./src/services/game/actions/start-game.ts","webpack:///./src/index.tsx","webpack:///./src/style.css?9819","webpack:///./src/style.css","webpack:///./src/root.tsx","webpack:///./src/theme/components/ThemeProvider.tsx","webpack:///./src/store/components/StoreProvider.tsx","webpack:///./src/store/store.ts","webpack:///./src/store/reducer.ts","webpack:///./src/state.ts","webpack:///./src/services/game/reducer/index.ts","webpack:///./src/services/game/reducer/place-token.ts","webpack:///./src/utils.ts","webpack:///./src/services/game/reducer/reset.ts","webpack:///./src/services/game/reducer/start-game.ts","webpack:///./src/store/saga.ts","webpack:///./src/store/devtool-sanitizer.ts","webpack:///./src/components/App.tsx","webpack:///./src/components/Game.tsx","webpack:///./src/components/Field.tsx","webpack:///./src/components/Grid.tsx","webpack:///./src/components/GridVisual.tsx","webpack:///./src/components/PositionedToken.tsx","webpack:///./src/components/Token.tsx","webpack:///./src/components/ResetButton.tsx","webpack:///./src/components/ModeSelect.tsx"],"names":["TOKENS_PER_GRID","GRIDS","AI_TOKEN","tokenSizePx","squareSizePx","gridSizePx","gameStateSelector","state","services","game","createGameSelector","localSelector","selector","createSelector","local","modeSelector","mode","tokensSelector","tokens","turnSelector","turn","winningEntry","winLine","tokensMatchWinLine","token","positions","winningToken","entry","winningPositions","defaultGameState","Object","freeze","fill","Array","getTokenIndexXY","x","y","grid","position","g","i","length","aiMoveOnLine","line","set","potentials","map","count","foundToken","tokenIndex","winLineWinningPotential","filter","isNotNull","highPriority","winningLine","find","advance","shuffle","Math","floor","random","ACTION_PLACE_TOKEN","placeToken","type","payload","action","iterateGridWinLines","gridPositions","winLinesComputed","from","getTokenIndexXYG","rowMajor","rowMinor","columnMajor","columnMinor","iterateWinLines","winLines","uniqBy","join","ACTION_RESET","reset","ACTION_START_GAME","startGame","rootEl","document","getElementById","ReactDOM","render","content","module","options","locals","exports","push","children","theme","Provider","store","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","actionSanitizer","stateSanitizer","actionsBlacklist","compose","sagaMiddleware","applyMiddleware","run","createStore","servicesReducer","combineReducers","defaultAppState","gameReducer","isPlaceTokenAction","performAiMove","array","a","result","pop","isResetAction","isStartGameAction","useSelector","range","gridIndex","key","width","height","gridTokenIndex","getTokenArrayIndex","childOffset","lineChildren","x1","y1","x2","y2","arrayChildren","React","Children","toArray","contentChildren","transform","strokeWidth","stroke","dispatcher","useDispatch","tokenState","isWinning","winningPosition","includes","onClick","useCallback","isWinningToken","tokenType","size","TokenX","color","TokenO","cx","cy","r","TokenBlank","dispatch","onLocal","onAI"],"mappings":"6IAAa,EAAAA,gBAAkB,EAClB,EAAAC,MAAQ,EAER,EAAAC,SAAW,K,iFCExB,UALc,CACZC,YAAa,GACbC,aAAc,GACdC,WAAY,M,qeCHd,YAMA,WACA,QAMA,SAASC,EAAkBC,GACzB,OAAOA,EAAMC,SAASC,KAGxB,SAASC,EACPC,GAEA,IAAMC,EAA4B,EAAAC,eAChCP,EACAK,GAGF,OADAC,EAASE,MAAQH,EACVC,EAGI,EAAAG,aAAe,SAACR,GAAoB,OAAAA,EAAMC,SAASC,KAAKO,MACxD,EAAAC,eAAiB,SAACV,GAAoB,OAAAA,EAAMC,SAASC,KAAKS,QAC1D,EAAAC,aAAe,SAACZ,GAAoB,OAAAA,EAAMC,SAASC,KAAKW,MAOrE,IAAMC,EAAe,EAAAR,gBACnB,SAACN,GAAqB,OAAAA,EAAMW,UAC5B,SAAAA,G,YACE,IAAsB,mBAAQ,8BAAE,CAA3B,IAAMI,EAAO,QACV,EAAe,EAAAC,mBAAmBL,EAAQI,GAChD,GAAK,EASL,MAL4B,CAC1BE,MAAO,EACPC,UAAWH,I,iGAMf,OAAO,QAIE,EAAAI,aAAehB,GAAqC,SAAAH,GAC/D,IAAMoB,EAAQN,EAAad,GAC3B,OAAIoB,EACKA,EAAMH,MAGR,QAGI,EAAAI,iBAAmBlB,GAAoC,SAAAH,GAClE,IAAMoB,EAAQN,EAAad,GAC3B,OAAIoB,EACKA,EAAMF,UAGR,S,+ECzET,YAGA,OAQa,EAAAI,iBAAwCC,OAAOC,OAAO,CACjEf,KAAM,KACNI,KAAM,IACNF,OAAQ,EAAAc,KAAK,IAAIC,MAAM,EAAAjC,gBAAkB,EAAAC,OAAQ,Y,8ECdnD,WAqBA,SAAgBiC,EAAgBC,EAAWC,GACzC,OAAW,EAAJA,EAAQD,EAdjB,8BAAmCE,EAAcC,GAC/C,OAAc,EAAPD,EAAWC,GAQpB,4BAAiCH,EAAWC,EAAWG,GACrD,OAAOA,EAAI,EAAAvC,gBAAkBkC,EAAgBC,EAAGC,IAGlD,oBAIA,8BACElB,EACAI,GAEA,IAAME,EAAQN,EAAOI,EAAQ,IAC7B,GAAc,UAAVE,EACF,OAAO,KAGT,IAAK,IAAIgB,EAAI,EAAGA,EAAIlB,EAAQmB,OAAQD,IAClC,GAAItB,EAAOI,EAAQkB,MAAQhB,EACzB,OAAO,KAIX,OAAOA,I,sYCxCT,YACA,QAEA,QAIA,WACA,OA8CA,SAASkB,EAAanC,EAAkBoC,GAEtC,IADQ,IAAAzB,EAAA,EAAAA,OACCsB,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAC1B,IAAMF,EAAWK,EAAKH,GACtB,GAAyB,UAArBtB,EAAOoB,GACT,OAAO,EAAP,KACK/B,GAAK,CACRW,OAAQ,EAAA0B,IAAM,CAACN,GAAW,EAAApC,SAAUK,EAAMW,UAKhD,OAAOX,EAnDT,yBAA8BA,GAC5B,IAAMsC,EAAa,UAChBC,KAAI,SAAAH,GAAQ,OA0DjB,SACEzB,EACAI,GAIA,IAFA,IAAIyB,EAAQ,EACRC,EAA+B,KAC1BR,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAC1B,IAAMS,EAAa3B,EAAQkB,GACrBhB,EAAQN,EAAO+B,GACrB,GAAkB,MAAdD,GACF,GAAIxB,IAAUwB,EACZD,SACK,GAAa,SAATvB,EAET,OAAO,SAES,SAATA,IACTwB,EAAaxB,EACbuB,KAIJ,IAAKC,EACH,OAAO,KAGT,MAAO,CACL1B,QAASA,EACTyB,MAAK,EACLvB,MAAOwB,GAvFME,CAAwB3C,EAAMW,OAAQyB,MAClDQ,OAAO,EAAAC,WAEJC,EAAeR,EAAWM,QAAO,SAAAhB,GAAK,OAAY,IAAZA,EAAEY,SAC9C,GAAIM,EAAaZ,OAAS,EAAG,CAE3B,IAAMa,EAAc,EAAAC,KAAKF,GAAc,SAAAlB,GAAK,OAAAA,EAAEX,OAAS,EAAAtB,YACvD,OACSwC,EAAanC,EADlB+C,EACyBA,EAAYhC,QAId+B,EAAa,GAAG/B,SAI7C,IAAIkC,EAAUX,EAAWM,QAAO,SAAAhB,GAAK,OAAY,IAAZA,EAAEY,OAAeZ,EAAEX,QAAU,EAAAtB,YAClE,GAAIsD,EAAQf,OAAS,EAEnB,OADAe,EAAU,EAAAC,QAAQD,GACXd,EAAanC,EAAOiD,EAAQ,GAAGlC,SAKxC,OAAa,CAEX,IAAMgB,EAAWoB,KAAKC,MAAMpD,EAAMW,OAAOuB,OAASiB,KAAKE,UACvD,GAA+B,UAA3BrD,EAAMW,OAAOoB,GAGjB,OAAO,EAAP,KACK/B,GAAK,CACRW,OAAQ,EAAA0B,IAAM,CAACN,GAAW,EAAApC,SAAUK,EAAMW,a,kFC/CnC,EAAA2C,mBAAqB,oBACrB,EAAAC,WAAa,SAACxB,GACzB,OACEyB,KAAM,EAAAF,mBACNG,QAAS,CAAE1B,SAAQ,KAGvB,8BACE2B,GAEA,OAAOA,EAAOF,OAAS,EAAAF,qB,k9CCZzB,YAEA,QAKA,SAAUK,EAAoBC,G,0DAEnB/B,EAAI,E,wBAAGA,EAAI,EAClB,GAAM,CACJ+B,EAAc,EAAAjC,gBAAgB,EAAGE,IACjC+B,EAAc,EAAAjC,gBAAgB,EAAGE,IACjC+B,EAAc,EAAAjC,gBAAgB,EAAGE,MAJhB,M,OACnB,S,wBADqBA,I,aASdD,EAAI,E,wBAAGA,EAAI,EAClB,GAAM,CACJgC,EAAc,EAAAjC,gBAAgBC,EAAG,IACjCgC,EAAc,EAAAjC,gBAAgBC,EAAG,IACjCgC,EAAc,EAAAjC,gBAAgBC,EAAG,MAJhB,M,OACnB,S,wBADqBA,I,aASvB,SAAM,CACJgC,EAAc,EAAAjC,gBAAgB,EAAG,IACjCiC,EAAc,EAAAjC,gBAAgB,EAAG,IACjCiC,EAAc,EAAAjC,gBAAgB,EAAG,M,OAEnC,OALA,SAKA,GAAM,CACJiC,EAAc,EAAAjC,gBAAgB,EAAG,IACjCiC,EAAc,EAAAjC,gBAAgB,EAAG,IACjCiC,EAAc,EAAAjC,gBAAgB,EAAG,M,eAHnC,S,QA4HF,IAAMkC,EAAmBnC,MAAMoC,KArH/B,W,gEAEW9B,EAAI,E,wBAAGA,EAAI,EAClB,KAAO2B,EAAoB,CACzB,EAAAI,iBAAiB,EAAG,EAAG/B,GACvB,EAAA+B,iBAAiB,EAAG,EAAG/B,GACvB,EAAA+B,iBAAiB,EAAG,EAAG/B,GACvB,EAAA+B,iBAAiB,EAAG,EAAG/B,GACvB,EAAA+B,iBAAiB,EAAG,EAAG/B,GACvB,EAAA+B,iBAAiB,EAAG,EAAG/B,GACvB,EAAA+B,iBAAiB,EAAG,EAAG/B,GACvB,EAAA+B,iBAAiB,EAAG,EAAG/B,GACvB,EAAA+B,iBAAiB,EAAG,EAAG/B,OAVN,M,OACnB,S,wBADqBA,I,aAedgC,EAAW,E,sBAAGA,EAAW,GAAC,aACxBC,EAAW,E,wBAAGA,EAAW,EAChC,KAAON,EAAoB,CACzB,EAAAI,iBAAiB,EAAGE,EAAqB,EAAXD,GAC9B,EAAAD,iBAAiB,EAAGE,EAAqB,EAAXD,GAC9B,EAAAD,iBAAiB,EAAGE,EAAqB,EAAXD,GAC9B,EAAAD,iBAAiB,EAAGE,EAAqB,EAAXD,EAAe,GAC7C,EAAAD,iBAAiB,EAAGE,EAAqB,EAAXD,EAAe,GAC7C,EAAAD,iBAAiB,EAAGE,EAAqB,EAAXD,EAAe,GAC7C,EAAAD,iBAAiB,EAAGE,EAAqB,EAAXD,EAAe,GAC7C,EAAAD,iBAAiB,EAAGE,EAAqB,EAAXD,EAAe,GAC7C,EAAAD,iBAAiB,EAAGE,EAAqB,EAAXD,EAAe,OAVd,M,OACjC,S,wBADmCC,I,oBADFD,I,cAiB5BA,EAAW,E,0BAAGA,EAAW,EAChC,KAAOL,EAAoB,CACzB,EAAAI,iBAAiB,EAAG,EAAc,EAAXC,GACvB,EAAAD,iBAAiB,EAAG,EAAc,EAAXC,GACvB,EAAAD,iBAAiB,EAAG,EAAc,EAAXC,GACvB,EAAAD,iBAAiB,EAAG,EAAc,EAAXC,EAAe,GACtC,EAAAD,iBAAiB,EAAG,EAAc,EAAXC,EAAe,GACtC,EAAAD,iBAAiB,EAAG,EAAc,EAAXC,EAAe,GACtC,EAAAD,iBAAiB,EAAG,EAAc,EAAXC,EAAe,GACtC,EAAAD,iBAAiB,EAAG,EAAc,EAAXC,EAAe,GACtC,EAAAD,iBAAiB,EAAG,EAAc,EAAXC,EAAe,OAVP,O,QAYjC,OAXA,SAWA,KAAOL,EAAoB,CACzB,EAAAI,iBAAiB,EAAG,EAAc,EAAXC,EAAe,GACtC,EAAAD,iBAAiB,EAAG,EAAc,EAAXC,EAAe,GACtC,EAAAD,iBAAiB,EAAG,EAAc,EAAXC,EAAe,GACtC,EAAAD,iBAAiB,EAAG,EAAc,EAAXC,EAAe,GACtC,EAAAD,iBAAiB,EAAG,EAAc,EAAXC,EAAe,GACtC,EAAAD,iBAAiB,EAAG,EAAc,EAAXC,EAAe,GACtC,EAAAD,iBAAiB,EAAG,EAAc,EAAXC,GACvB,EAAAD,iBAAiB,EAAG,EAAc,EAAXC,GACvB,EAAAD,iBAAiB,EAAG,EAAc,EAAXC,O,QATzB,S,0BAZmCA,I,eA0B5BE,EAAc,E,wBAAGA,EAAc,GAAC,aAC9BC,EAAc,E,0BAAGA,EAAc,EACtC,KAAOR,EAAoB,CACzB,EAAAI,iBAAiBI,EAAa,EAAGD,GACjC,EAAAH,iBAAiBI,EAAa,EAAGD,GACjC,EAAAH,iBAAiBI,EAAa,EAAGD,GACjC,EAAAH,iBAAiBI,EAAa,EAAGD,EAAc,GAC/C,EAAAH,iBAAiBI,EAAa,EAAGD,EAAc,GAC/C,EAAAH,iBAAiBI,EAAa,EAAGD,EAAc,GAC/C,EAAAH,iBAAiBI,EAAa,EAAGD,EAAc,GAC/C,EAAAH,iBAAiBI,EAAa,EAAGD,EAAc,GAC/C,EAAAH,iBAAiBI,EAAa,EAAGD,EAAc,OAVV,O,QACvC,S,0BADyCC,I,sBADFD,I,eAiBlCA,EAAc,E,0BAAGA,EAAc,EACtC,KAAOP,EAAoB,CACzB,EAAAI,iBAAiB,EAAG,EAAGG,GACvB,EAAAH,iBAAiB,EAAG,EAAGG,GACvB,EAAAH,iBAAiB,EAAG,EAAGG,GACvB,EAAAH,iBAAiB,EAAG,EAAGG,EAAc,GACrC,EAAAH,iBAAiB,EAAG,EAAGG,EAAc,GACrC,EAAAH,iBAAiB,EAAG,EAAGG,EAAc,GACrC,EAAAH,iBAAiB,EAAG,EAAGG,EAAc,GACrC,EAAAH,iBAAiB,EAAG,EAAGG,EAAc,GACrC,EAAAH,iBAAiB,EAAG,EAAGG,EAAc,OAVA,O,QAYvC,OAXA,SAWA,KAAOP,EAAoB,CACzB,EAAAI,iBAAiB,EAAG,EAAGG,EAAc,GACrC,EAAAH,iBAAiB,EAAG,EAAGG,EAAc,GACrC,EAAAH,iBAAiB,EAAG,EAAGG,EAAc,GACrC,EAAAH,iBAAiB,EAAG,EAAGG,EAAc,GACrC,EAAAH,iBAAiB,EAAG,EAAGG,EAAc,GACrC,EAAAH,iBAAiB,EAAG,EAAGG,EAAc,GACrC,EAAAH,iBAAiB,EAAG,EAAGG,GACvB,EAAAH,iBAAiB,EAAG,EAAGG,GACvB,EAAAH,iBAAiB,EAAG,EAAGG,O,QATzB,S,0BAZyCA,I,eA0B3C,SAAM,CACJ,EAAAH,iBAAiB,EAAG,EAAG,GACvB,EAAAA,iBAAiB,EAAG,EAAG,GACvB,EAAAA,iBAAiB,EAAG,EAAG,K,QAEzB,OALA,SAKA,GAAM,CACJ,EAAAA,iBAAiB,EAAG,EAAG,GACvB,EAAAA,iBAAiB,EAAG,EAAG,GACvB,EAAAA,iBAAiB,EAAG,EAAG,K,eAHzB,S,QASkCK,IAC9BC,EAAW,EAAAC,OAAOT,GAAkB,SAAAjC,GAAK,OAAAA,EAAE2C,KAAK,QAEtD,UAAeF,G,8EC7JF,EAAAG,aAAe,cACf,EAAAC,MAAQ,WACnB,OACEjB,KAAM,EAAAgB,eAGV,yBAA8Bd,GAC5B,OAAOA,EAAOF,OAAS,EAAAgB,e,8ECNZ,EAAAE,kBAAoB,cACpB,EAAAC,UAAY,SAAClE,GACxB,OACE+C,KAAM,EAAAkB,kBACNjB,QAAS,CAAEhD,KAAI,KAGnB,6BAAkCiD,GAChC,OAAOA,EAAOF,OAAS,EAAAkB,oB,6WCXzB,MAEA,MAEA,cACA,WAEA,WAEME,EAASC,SAASC,eAAe,QACnCF,GACFG,EAASC,OAAO,gBAAC,UAAI,MAAKJ,I,iBCX5B,IAAIK,EAAU,EAAQ,IAEC,iBAAZA,IACTA,EAAU,CAAC,CAACC,EAAOjD,EAAIgD,EAAS,MAGlC,IAAIE,EAAU,CAEd,OAAiB,OACjB,WAAoB,GAEP,EAAQ,GAAR,CAAkFF,EAASE,GAEpGF,EAAQG,SACVF,EAAOG,QAAUJ,EAAQG,S,iBCdjBF,EAAOG,QAAU,EAAQ,GAAR,EAA0D,IAE7EC,KAAK,CAACJ,EAAOjD,EAAI,0LAA2L,M,iVCFpN,cAEA,WACA,WAEA,WAUA,UARuB,WAAM,OAC3B,gBAAC,UAAa,KACZ,gBAAC,UAAa,KACZ,gBAAC,UAAG,U,2UCVV,cAEA,QAEA,WAQA,UANgC,SAAC,G,IAAEsD,EAAA,EAAAA,SAAe,OAChD,gBAAC,gBAAW,CAACC,MAAO,WAClB,gCAAGD,M,gVCRP,cAEA,OAEA,WAKA,UAHgC,SAAC,G,IAAEA,EAAA,EAAAA,SAAe,OAChD,gBAAC,EAAAE,SAAQ,CAACC,MAAO,WAAQH,K,kKCP3B,WAMA,WAEA,WACA,WAEA,QA0BA,IAAMG,EApBN,WACE,IAAMC,EACHC,OAAOC,sCACND,OAAOC,qCAAqC,CAC1CC,gBAAe,kBACfC,eAAc,iBACdC,iBAAgB,sBAEpB,EAAAC,QAEIC,EAAiB,YAEjBR,EAAQ,cACZ,UACAC,EAAiB,EAAAQ,gBAAgBD,KAGnC,OADAA,EAAeE,IAAI,WACZV,EAGKW,GACd,UAAeX,G,kKCtCf,WAEA,QACA,WAGMY,EAAkB,EAAAC,gBAAgB,CAEtCrG,KAAM,YAGR,mBACEF,EACA0D,GAEA,YAHA,IAAA1D,MAAkB,EAAAwG,iBAGX,CACLvG,SAAUqG,EAAgBtG,EAAMC,SAAUyD,M,8EChB9C,YAQa,EAAA8C,gBAAsCjF,OAAOC,OAAO,CAC/DvB,SAAU,CACRC,KAAM,EAAAoB,qB,kKCVV,eAIA,WACA,WACA,WAEMmF,EAAc,UAClB,UACA,UACA,WAEF,UAAeA,G,uTCXf,YAIA,QACA,QACA,QACA,OAGA,QAEA,mBACEzG,EACA0D,GAEA,QAHA,IAAA1D,MAAmB,EAAAsB,mBAGd,EAAAoF,mBAAmBhD,GACtB,OAAO1D,EAIT,GAAI,EAAAqB,iBAAiBd,MAAMP,GACzB,OAAOA,EAGD,IAAA+B,EAAA,UAAAA,SAER,MAA+B,UAA3B/B,EAAMW,OAAOoB,GACR/B,GAUQ,QAPjBA,EAAQ,EAAH,KACAA,GAAK,CACRW,OAAQ,EAAA0B,IAAM,CAACN,GAAW/B,EAAMa,KAAMb,EAAMW,QAC5CE,KAAqB,MAAfb,EAAMa,KAAe,IAAM,OAI3BJ,MACNT,EAAMa,OAAS,EAAAlB,UACc,MAA7B,EAAAwB,aAAaZ,MAAMP,KAEnBA,EAAQ,EAAA2G,cAAc3G,GACtBA,EAAQ,EAAH,KACAA,GAAK,CACRa,KAAqB,MAAfb,EAAMa,KAAe,IAAM,OAI9Bb,K,ofCnDT,uBAA+B4G,EAAYpE,GAMzC,IALA,IAAMqE,EAAI,EAAID,GAEVE,EAAgB,GAChBlB,EAAc,GAEXiB,EAAE3E,OAAS,GAChB0D,EAAON,KAAKuB,EAAEE,OACVnB,EAAO1D,SAAWM,IACpBsE,EAAOxB,KAAKM,GACZA,EAAS,IAQb,OAJIA,EAAO1D,OAAS,GAClB4E,EAAOxB,KAAKM,GAGPkB,GAGT,qBAA6BlF,GAC3B,OAAY,MAALA,I,sTCtBT,YAEA,QACA,QAEA,mBACE5B,EACA0D,GAEA,YAHA,IAAA1D,MAAmB,EAAAsB,kBAGd,EAAA0F,cAActD,IASA,QALnB1D,EAAQ,EAAH,KACA,EAAAsB,kBAAgB,CACnBb,KAAMT,EAAMS,QAGJA,OACRT,EAAQ,EAAA2G,cAAc3G,IAGjBA,GAZEA,I,sTCPX,YACA,QAEA,mBACEA,EACA0D,GAEA,IAAK,EAAAuD,kBAAkBvD,GACrB,OAAO1D,EAGD,IAAAS,EAAA,UAAAA,KAOR,MAJa,OAATA,IACFT,EAAQ,EAAA2G,cAAc3G,IAGjB,EAAP,KACKA,GAAK,CACRS,KAAI,M,ipCCrBR,qBAAiC,2B,6FCEpB,EAAAuF,iBAA6B,GAE1C,2BAAgCtC,GAC9B,OAAOA,GAGT,0BAA+B1D,GAC7B,OAAOA,I,2UCXT,cACA,OAEA,QAEA,WACA,WAUA,UARsB,WAEpB,OAAY,MADC,EAAAkH,YAAY,EAAA1G,cAEhB,gBAAC,UAAU,MAEb,gBAAC,UAAI,Q,2UCbd,cACA,OACA,QAEA,OACA,QAEA,WAEA,WACA,WACA,WA0BA,UAxBuB,WACrB,IAAMK,EAAO,EAAAqG,YAAY,EAAAtG,cACzB,OACE,2BACE,gBAAC,UAAK,KACH,EAAAuG,MAAM,EAAG,EAAAzH,OAAO6C,KAAI,SAAA6E,GACnB,IAAMxF,EAAIwF,EAAY,EAChBvF,EAAIsB,KAAKC,MAAMgE,EAAY,GACjC,OACE,gBAAC,UAAI,CACHC,IAAKD,EACLA,UAAWA,EACXxF,EAAG,UAAM9B,WAAa8B,EAAI,GAC1BC,EAAG,UAAM/B,WAAa+B,EAAI,SAKlC,2B,SAAYhB,GACZ,gBAAC,UAAW,S,2UChClB,cAEA,WAUA,UARwB,SAAC,G,IAAE0E,EAAA,EAAAA,SACzB,OACE,uBAAK+B,MAA0B,EAAnB,UAAMxH,WAAiB,GAAIyH,OAA2B,EAAnB,UAAMzH,WAAiB,IACnEyF,K,2UCPP,cACA,QAEA,OACA,QAEA,WACA,WAmBA,UAXkC,SAAC,G,IAAE3D,EAAA,EAAAA,EAAGC,EAAA,EAAAA,EAAGuF,EAAA,EAAAA,UACzC,OACE,gBAAC,UAAU,CAACxF,EAAGA,EAAGC,EAAGA,GAClB,EAAAsF,MAAM,EAAG,EAAA1H,iBAAiB8C,KAAI,SAAAiF,GAC7B,IAAMzF,EAAW,EAAA0F,mBAAmBL,EAAWI,GAC/C,OAAO,gBAAC,UAAe,CAACH,IAAKtF,EAAUA,SAAUA,U,2UCpBzD,cAEA,WAEM2F,GAAe,UAAM7H,aAAe,UAAMD,aAAe,EAwD/D,UAjDwC,SAAC,GAEvC,I,IAFyCgC,EAAA,EAAAA,EAAGC,EAAA,EAAAA,EAAG0D,EAAA,EAAAA,SACzCoC,EAAkC,GAC/B1F,EAAI,EAAGA,GAAK,EAAGA,IACtB0F,EAAarC,KACX,wBACE+B,IAAK,IAAIpF,EACT2F,GAAI,EACJC,GAAI,UAAMhI,aAAeoC,EACzB6F,GAAyB,EAArB,UAAMjI,aACVkI,GAAI,UAAMlI,aAAeoC,KAG7B0F,EAAarC,KACX,wBACE+B,IAAK,IAAIpF,EACT4F,GAAI,EACJD,GAAI,UAAM/H,aAAeoC,EACzB8F,GAAyB,EAArB,UAAMlI,aACViI,GAAI,UAAMjI,aAAeoC,KAK/B,IAAM+F,EAAgBC,EAAMC,SAASC,QAAQ5C,GACvC6C,EAAqC,GAC3C,IAASnG,EAAI,EAAGA,EAAI+F,EAAc9F,OAAQD,IAAK,CAC7C,IAAM,EAAIA,EAAI,EACR,EAAIkB,KAAKC,MAAMnB,EAAI,GACzBmG,EAAgB9C,KACd,qBACE+C,UAAW,cAAa,UAAMxI,aAAe,EAC3C6H,GAAW,MAAK,UAAM7H,aAAe,EAAI6H,GAAW,IACtDL,IAAK,KAAKpF,GAET+F,EAAc/F,KAKrB,OACE,qBAAGoG,UAAW,aAAazG,EAAC,KAAKC,EAAC,KAChC,qBAAGyG,YAAa,EAAGC,OAAO,SACvBZ,GAEFS,K,2UCvDP,cACA,OAGA,QACA,QAEA,WA2BA,UAzBwD,SAAC,G,IAAErG,EAAA,EAAAA,SACnDyG,EAAa,EAAAC,cACbC,EAAa,EAAAxB,aACjB,SAAClH,GAAoB,OAAAA,EAAMC,SAASC,KAAKS,OAAOoB,MAG9C4G,GAAY,EACVC,EAAkB,EAAA1B,YAAY,EAAA7F,kBAChCuH,GAAmBA,EAAgBC,SAAS9G,KAC9C4G,GAAY,GAGd,IAAMG,EAAUb,EAAMc,aAAY,WAChCP,EAAW,EAAAjF,WAAWxB,MACrB,CAACA,IAEJ,OACE,gBAAC,UAAK,CACJiH,eAAgBL,EAChBM,UAAWP,EACXI,QAASA,M,2UC7Bf,cAgBMI,EAdN,SAca,QAAMtJ,YAEbuJ,EAAmC,SAAC,G,IAAEL,EAAA,EAAAA,QAASM,EAAA,EAAAA,MAAY,OAC/D,qBAAGd,YAAa,EAAGC,OAAQa,EAAON,QAASA,GACzC,wBAAMR,YAAa,EAAG7G,KAAK,cAAc6F,MAAO4B,EAAM3B,OAAQ2B,IAC9D,wBAAMtB,GAAI,EAAGC,GAAI,EAAGC,GAAIoB,EAAMnB,GAAImB,IAClC,wBAAMtB,GAAIsB,EAAMrB,GAAI,EAAGC,GAAI,EAAGC,GAAImB,MAGhCG,EAAmC,SAAC,G,IAAEP,EAAA,EAAAA,QAASM,EAAA,EAAAA,MAAY,OAC/D,qBAAGd,YAAa,EAAGC,OAAQa,EAAO3H,KAAK,OAAOqH,QAASA,GACrD,wBAAMR,YAAa,EAAG7G,KAAK,cAAc6F,MAAO4B,EAAM3B,OAAQ2B,IAC9D,0BAAQI,GAAIJ,EAAO,EAAGK,GAAIL,EAAO,EAAGM,EAAGN,EAAO,MAI5CO,EAAuC,SAAC,G,IAAEX,EAAA,EAAAA,QAAc,OAC5D,wBAAMrH,KAAK,cAAc6F,MAAO4B,EAAM3B,OAAQ2B,EAAMJ,QAASA,KAqB/D,UAlBoC,SAAC,G,IACnCG,EAAA,EAAAA,UACAD,EAAA,EAAAA,eACAF,EAAA,EAAAA,QAEMM,EAAQJ,EAAiB,MAAQ,QACvC,OAAQC,GACN,IAAK,IACH,OAAO,gBAACE,EAAM,CAACC,MAAOA,EAAON,QAASA,IACxC,IAAK,IACH,OAAO,gBAACO,EAAM,CAACD,MAAOA,EAAON,QAASA,IACxC,IAAK,QACH,OAAO,gBAACW,EAAU,CAACL,MAAM,cAAcN,QAASA,IAClD,QACE,OAAO,uC,2PClDb,cACA,OAEA,QAWA,UAT8B,WAC5B,IAAMY,EAAW,EAAAjB,cACXK,EAAUb,EAAMc,aAAY,WAChCW,EAAS,EAAAjF,WACR,CAACiF,IAEJ,OAAO,0BAAQZ,QAASA,GAAO,W,2PCXjC,cACA,OACA,QAkBA,UAhB6B,WAC3B,IAAMY,EAAW,EAAAjB,cACXkB,EAAU1B,EAAMc,aAAY,WAChCW,EAAS,EAAA/E,UAAU,YAClB,CAAC+E,IACEE,EAAO3B,EAAMc,aAAY,WAC7BW,EAAS,EAAA/E,UAAU,SAClB,CAAC+E,IACJ,OACE,2BACE,0BAAQZ,QAASa,GAAO,kBACxB,0BAAQb,QAASc,GAAI,a","file":"client.7b05c13381063b1170f9.bundle.js","sourcesContent":["export const TOKENS_PER_GRID = 9;\r\nexport const GRIDS = 9;\r\n\r\nexport const AI_TOKEN = \"o\";\r\n","const theme = {\r\n  tokenSizePx: 20,\r\n  squareSizePx: 30,\r\n  gridSizePx: 30 * 3 + 20\r\n};\r\nexport default theme;\r\n\r\nexport type Theme = typeof theme;\r\n","import { createSelector } from \"reselect\";\r\n\r\nimport { AppState, AppSelector } from \"@/state\";\r\n\r\nimport { GameState } from \"./state\";\r\nimport { TokenType } from \"./types\";\r\nimport winLines from \"./win-lines\";\r\nimport { tokensMatchWinLine } from \"./utils\";\r\n\r\ntype LocalGameSelector<T> = (state: GameState) => T;\r\n\r\ntype GameSelector<T> = AppSelector<T> & { local: LocalGameSelector<T> };\r\n\r\nfunction gameStateSelector(state: AppState) {\r\n  return state.services.game;\r\n}\r\n\r\nfunction createGameSelector<T>(\r\n  localSelector: LocalGameSelector<T>\r\n): GameSelector<T> {\r\n  const selector: GameSelector<T> = createSelector(\r\n    gameStateSelector,\r\n    localSelector\r\n  ) as any;\r\n  selector.local = localSelector;\r\n  return selector;\r\n}\r\n\r\nexport const modeSelector = (state: AppState) => state.services.game.mode;\r\nexport const tokensSelector = (state: AppState) => state.services.game.tokens;\r\nexport const turnSelector = (state: AppState) => state.services.game.turn;\r\n\r\ninterface WinningEntry {\r\n  token: TokenType;\r\n  positions: [number, number, number];\r\n}\r\n\r\nconst winningEntry = createSelector(\r\n  (state: GameState) => state.tokens,\r\n  tokens => {\r\n    for (const winLine of winLines) {\r\n      const winningToken = tokensMatchWinLine(tokens, winLine);\r\n      if (!winningToken) {\r\n        continue;\r\n      }\r\n\r\n      const entry: WinningEntry = {\r\n        token: winningToken,\r\n        positions: winLine\r\n      };\r\n\r\n      return entry;\r\n    }\r\n\r\n    return null;\r\n  }\r\n);\r\n\r\nexport const winningToken = createGameSelector<TokenType | null>(state => {\r\n  const entry = winningEntry(state);\r\n  if (entry) {\r\n    return entry.token;\r\n  }\r\n\r\n  return null;\r\n});\r\n\r\nexport const winningPositions = createGameSelector<number[] | null>(state => {\r\n  const entry = winningEntry(state);\r\n  if (entry) {\r\n    return entry.positions;\r\n  }\r\n\r\n  return null;\r\n});\r\n","import { fill } from \"lodash\";\r\n\r\nimport { TokenType, TokensArray, GameMode } from \"./types\";\r\nimport { GRIDS, TOKENS_PER_GRID } from \"./consts\";\r\n\r\nexport interface GameState {\r\n  mode: GameMode | null;\r\n  turn: TokenType;\r\n  tokens: TokensArray;\r\n}\r\n\r\nexport const defaultGameState: Readonly<GameState> = Object.freeze({\r\n  mode: null,\r\n  turn: \"x\",\r\n  tokens: fill(new Array(TOKENS_PER_GRID * GRIDS), \"blank\") as TokensArray\r\n});\r\n","import { TOKENS_PER_GRID } from \"./consts\";\r\nimport { TokenType, WinLine, TokensArray } from \"./types\";\r\n\r\n/**\r\n * Calculate the tokens array index of a particular token slot.\r\n * @param grid The grid index.  0 is upper left, 8 is lower right.\r\n * @param position The position inside the grid.  0 is upper left, 8 is lower right.\r\n */\r\nexport function getTokenArrayIndex(grid: number, position: number): number {\r\n  return grid * 9 + position;\r\n}\r\n\r\n/**\r\n * Calculate the index of a token from x and y without regard for which grid.\r\n * @param x\r\n * @param y\r\n */\r\nexport function getTokenIndexXYG(x: number, y: number, g: number): number {\r\n  return g * TOKENS_PER_GRID + getTokenIndexXY(x, y);\r\n}\r\n\r\nexport function getTokenIndexXY(x: number, y: number): number {\r\n  return y * 3 + x;\r\n}\r\n\r\nexport function tokensMatchWinLine(\r\n  tokens: TokensArray,\r\n  winLine: WinLine\r\n): TokenType | null {\r\n  const token = tokens[winLine[0]];\r\n  if (token === \"blank\") {\r\n    return null;\r\n  }\r\n\r\n  for (let i = 1; i < winLine.length; i++) {\r\n    if (tokens[winLine[i]] !== token) {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  return token;\r\n}\r\n","import { find, shuffle } from \"lodash\";\r\nimport { set as setFp } from \"lodash/fp\";\r\n\r\nimport { isNotNull } from \"@/utils\";\r\n\r\nimport { GameState } from \"../state\";\r\nimport { WinLine, TokenType, TokensArray } from \"../types\";\r\nimport winLines from \"../win-lines\";\r\nimport { AI_TOKEN } from \"../consts\";\r\n\r\ninterface WinLinePotential {\r\n  winLine: WinLine;\r\n  count: number;\r\n  token: TokenType;\r\n}\r\nexport function performAiMove(state: GameState): GameState {\r\n  const potentials = winLines\r\n    .map(line => winLineWinningPotential(state.tokens, line))\r\n    .filter(isNotNull);\r\n\r\n  const highPriority = potentials.filter(x => x.count === 2);\r\n  if (highPriority.length > 0) {\r\n    // First, try to win.\r\n    const winningLine = find(highPriority, x => x.token == AI_TOKEN);\r\n    if (winningLine) {\r\n      return aiMoveOnLine(state, winningLine.winLine);\r\n    }\r\n\r\n    // Try to block the opponent\r\n    return aiMoveOnLine(state, highPriority[0].winLine);\r\n  }\r\n\r\n  // Try to advance, ignore what the player is doing\r\n  let advance = potentials.filter(x => x.count === 1 && x.token === AI_TOKEN);\r\n  if (advance.length > 0) {\r\n    advance = shuffle(advance);\r\n    return aiMoveOnLine(state, advance[0].winLine);\r\n  }\r\n\r\n  // I dunno... Move randomly.\r\n  //  Probably could have a list of good starting moves here.\r\n  while (true) {\r\n    // Note: Use of random breaks reducer purity here.\r\n    const position = Math.floor(state.tokens.length * Math.random());\r\n    if (state.tokens[position] !== \"blank\") {\r\n      continue;\r\n    }\r\n    return {\r\n      ...state,\r\n      tokens: setFp([position], AI_TOKEN, state.tokens)\r\n    };\r\n  }\r\n}\r\n\r\nfunction aiMoveOnLine(state: GameState, line: WinLine): GameState {\r\n  const { tokens } = state;\r\n  for (let i = 0; i < 3; i++) {\r\n    const position = line[i];\r\n    if (tokens[position] === \"blank\") {\r\n      return {\r\n        ...state,\r\n        tokens: setFp([position], AI_TOKEN, state.tokens)\r\n      };\r\n    }\r\n  }\r\n\r\n  return state;\r\n}\r\n\r\n/**\r\n * Returns the count of tokens on the line from 0 to 3.\r\n * Returns -1 if the line is unwinnable (blocked by both tokens present).\r\n * @param tokens\r\n * @param winLine\r\n */\r\nfunction winLineWinningPotential(\r\n  tokens: TokensArray,\r\n  winLine: WinLine\r\n): WinLinePotential | null {\r\n  let count = 0;\r\n  let foundToken: TokenType | null = null;\r\n  for (let i = 0; i < 3; i++) {\r\n    const tokenIndex = winLine[i];\r\n    const token = tokens[tokenIndex];\r\n    if (foundToken != null) {\r\n      if (token === foundToken) {\r\n        count++;\r\n      } else if (token != \"blank\") {\r\n        // Line is blocked\r\n        return null;\r\n      }\r\n    } else if (token != \"blank\") {\r\n      foundToken = token;\r\n      count++;\r\n    }\r\n  }\r\n\r\n  if (!foundToken) {\r\n    return null;\r\n  }\r\n\r\n  return {\r\n    winLine: winLine,\r\n    count,\r\n    token: foundToken\r\n  };\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_PLACE_TOKEN = \"@game/place-token\";\r\nexport const placeToken = (position: number) =>\r\n  ({\r\n    type: ACTION_PLACE_TOKEN,\r\n    payload: { position }\r\n  } as const);\r\nexport type PlaceTokenAction = ReturnType<typeof placeToken>;\r\nexport function isPlaceTokenAction(\r\n  action: AnyAction\r\n): action is PlaceTokenAction {\r\n  return action.type === ACTION_PLACE_TOKEN;\r\n}\r\n","import { uniqBy } from \"lodash\";\r\n\r\nimport { getTokenIndexXY, getTokenIndexXYG } from \"./utils\";\r\nimport { WinLine } from \"./types\";\r\n\r\n// There is porbably a more elegant way of finding the win lines...\r\n\r\nfunction* iterateGridWinLines(gridPositions: number[]): Iterable<WinLine> {\r\n  // horiz\r\n  for (let y = 0; y < 3; y++) {\r\n    yield [\r\n      gridPositions[getTokenIndexXY(0, y)],\r\n      gridPositions[getTokenIndexXY(1, y)],\r\n      gridPositions[getTokenIndexXY(2, y)]\r\n    ];\r\n  }\r\n\r\n  // vert\r\n  for (let x = 0; x < 3; x++) {\r\n    yield [\r\n      gridPositions[getTokenIndexXY(x, 0)],\r\n      gridPositions[getTokenIndexXY(x, 1)],\r\n      gridPositions[getTokenIndexXY(x, 2)]\r\n    ];\r\n  }\r\n\r\n  // cross\r\n  yield [\r\n    gridPositions[getTokenIndexXY(0, 0)],\r\n    gridPositions[getTokenIndexXY(1, 1)],\r\n    gridPositions[getTokenIndexXY(2, 2)]\r\n  ];\r\n  yield [\r\n    gridPositions[getTokenIndexXY(2, 0)],\r\n    gridPositions[getTokenIndexXY(1, 1)],\r\n    gridPositions[getTokenIndexXY(0, 2)]\r\n  ];\r\n}\r\n\r\nfunction* iterateWinLines(): Iterable<WinLine> {\r\n  // Grids\r\n  for (let g = 0; g < 3; g++) {\r\n    yield* iterateGridWinLines([\r\n      getTokenIndexXYG(0, 0, g),\r\n      getTokenIndexXYG(1, 0, g),\r\n      getTokenIndexXYG(2, 0, g),\r\n      getTokenIndexXYG(0, 1, g),\r\n      getTokenIndexXYG(1, 1, g),\r\n      getTokenIndexXYG(2, 1, g),\r\n      getTokenIndexXYG(0, 2, g),\r\n      getTokenIndexXYG(1, 2, g),\r\n      getTokenIndexXYG(2, 2, g)\r\n    ]);\r\n  }\r\n\r\n  // Grid row slices\r\n  for (let rowMajor = 0; rowMajor < 3; rowMajor++) {\r\n    for (let rowMinor = 0; rowMinor < 3; rowMinor++) {\r\n      yield* iterateGridWinLines([\r\n        getTokenIndexXYG(0, rowMinor, rowMajor * 3),\r\n        getTokenIndexXYG(1, rowMinor, rowMajor * 3),\r\n        getTokenIndexXYG(2, rowMinor, rowMajor * 3),\r\n        getTokenIndexXYG(0, rowMinor, rowMajor * 3 + 1),\r\n        getTokenIndexXYG(1, rowMinor, rowMajor * 3 + 1),\r\n        getTokenIndexXYG(2, rowMinor, rowMajor * 3 + 1),\r\n        getTokenIndexXYG(0, rowMinor, rowMajor * 3 + 2),\r\n        getTokenIndexXYG(1, rowMinor, rowMajor * 3 + 2),\r\n        getTokenIndexXYG(2, rowMinor, rowMajor * 3 + 2)\r\n      ]);\r\n    }\r\n  }\r\n\r\n  // Grid row cross axis\r\n  for (let rowMajor = 0; rowMajor < 3; rowMajor++) {\r\n    yield* iterateGridWinLines([\r\n      getTokenIndexXYG(0, 0, rowMajor * 3),\r\n      getTokenIndexXYG(0, 1, rowMajor * 3),\r\n      getTokenIndexXYG(0, 2, rowMajor * 3),\r\n      getTokenIndexXYG(1, 0, rowMajor * 3 + 1),\r\n      getTokenIndexXYG(1, 1, rowMajor * 3 + 1),\r\n      getTokenIndexXYG(1, 2, rowMajor * 3 + 1),\r\n      getTokenIndexXYG(2, 0, rowMajor * 3 + 2),\r\n      getTokenIndexXYG(2, 1, rowMajor * 3 + 2),\r\n      getTokenIndexXYG(2, 2, rowMajor * 3 + 2)\r\n    ]);\r\n    yield* iterateGridWinLines([\r\n      getTokenIndexXYG(0, 0, rowMajor * 3 + 2),\r\n      getTokenIndexXYG(0, 1, rowMajor * 3 + 2),\r\n      getTokenIndexXYG(0, 2, rowMajor * 3 + 2),\r\n      getTokenIndexXYG(1, 0, rowMajor * 3 + 1),\r\n      getTokenIndexXYG(1, 1, rowMajor * 3 + 1),\r\n      getTokenIndexXYG(1, 2, rowMajor * 3 + 1),\r\n      getTokenIndexXYG(2, 0, rowMajor * 3),\r\n      getTokenIndexXYG(2, 1, rowMajor * 3),\r\n      getTokenIndexXYG(2, 2, rowMajor * 3)\r\n    ]);\r\n  }\r\n\r\n  // Grid column slices\r\n  for (let columnMajor = 0; columnMajor < 3; columnMajor++) {\r\n    for (let columnMinor = 0; columnMinor < 3; columnMinor++) {\r\n      yield* iterateGridWinLines([\r\n        getTokenIndexXYG(columnMinor, 0, columnMajor),\r\n        getTokenIndexXYG(columnMinor, 1, columnMajor),\r\n        getTokenIndexXYG(columnMinor, 2, columnMajor),\r\n        getTokenIndexXYG(columnMinor, 0, columnMajor + 3),\r\n        getTokenIndexXYG(columnMinor, 1, columnMajor + 3),\r\n        getTokenIndexXYG(columnMinor, 2, columnMajor + 3),\r\n        getTokenIndexXYG(columnMinor, 0, columnMajor + 6),\r\n        getTokenIndexXYG(columnMinor, 1, columnMajor + 6),\r\n        getTokenIndexXYG(columnMinor, 2, columnMajor + 6)\r\n      ]);\r\n    }\r\n  }\r\n\r\n  // Grid column cross axis\r\n  for (let columnMajor = 0; columnMajor < 3; columnMajor++) {\r\n    yield* iterateGridWinLines([\r\n      getTokenIndexXYG(0, 0, columnMajor),\r\n      getTokenIndexXYG(1, 0, columnMajor),\r\n      getTokenIndexXYG(2, 0, columnMajor),\r\n      getTokenIndexXYG(0, 1, columnMajor + 3),\r\n      getTokenIndexXYG(1, 1, columnMajor + 3),\r\n      getTokenIndexXYG(2, 1, columnMajor + 3),\r\n      getTokenIndexXYG(0, 2, columnMajor + 6),\r\n      getTokenIndexXYG(1, 2, columnMajor + 6),\r\n      getTokenIndexXYG(2, 2, columnMajor + 6)\r\n    ]);\r\n    yield* iterateGridWinLines([\r\n      getTokenIndexXYG(0, 0, columnMajor + 6),\r\n      getTokenIndexXYG(1, 0, columnMajor + 6),\r\n      getTokenIndexXYG(2, 0, columnMajor + 6),\r\n      getTokenIndexXYG(0, 1, columnMajor + 3),\r\n      getTokenIndexXYG(1, 1, columnMajor + 3),\r\n      getTokenIndexXYG(2, 1, columnMajor + 3),\r\n      getTokenIndexXYG(0, 2, columnMajor),\r\n      getTokenIndexXYG(1, 2, columnMajor),\r\n      getTokenIndexXYG(2, 2, columnMajor)\r\n    ]);\r\n  }\r\n\r\n  // // Crosses for second-level grid.\r\n  yield [\r\n    getTokenIndexXYG(0, 0, 0),\r\n    getTokenIndexXYG(1, 1, 4),\r\n    getTokenIndexXYG(2, 2, 8)\r\n  ];\r\n  yield [\r\n    getTokenIndexXYG(2, 0, 2),\r\n    getTokenIndexXYG(1, 1, 4),\r\n    getTokenIndexXYG(0, 2, 6)\r\n  ];\r\n}\r\n\r\n// Generating each combination of boards producees significant duplicates.\r\n//  Clean up the dups to simplify the list\r\nconst winLinesComputed = Array.from(iterateWinLines());\r\nconst winLines = uniqBy(winLinesComputed, x => x.join(\"-\"));\r\n\r\nexport default winLines;\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_RESET = \"@game/reset\";\r\nexport const reset = () =>\r\n  ({\r\n    type: ACTION_RESET\r\n  } as const);\r\ntype ResetAction = ReturnType<typeof reset>;\r\nexport function isResetAction(action: AnyAction): action is ResetAction {\r\n  return action.type === ACTION_RESET;\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport { GameMode } from \"../types\";\r\n\r\nexport const ACTION_START_GAME = \"@game/start\";\r\nexport const startGame = (mode: GameMode) =>\r\n  ({\r\n    type: ACTION_START_GAME,\r\n    payload: { mode }\r\n  } as const);\r\ntype ResetAction = ReturnType<typeof startGame>;\r\nexport function isStartGameAction(action: AnyAction): action is ResetAction {\r\n  return action.type === ACTION_START_GAME;\r\n}\r\n","import \"resize-observer-polyfill\";\r\n\r\nimport \"@/style.css\";\r\n\r\nimport * as React from \"react\";\r\nimport * as ReactDOM from \"react-dom\";\r\n\r\nimport Root from \"./root\";\r\n\r\nconst rootEl = document.getElementById(\"root\");\r\nif (rootEl) {\r\n  ReactDOM.render(<Root />, rootEl);\r\n}\r\n","var content = require(\"!!../node_modules/css-loader/dist/cjs.js!./style.css\");\n\nif (typeof content === 'string') {\n  content = [[module.id, content, '']];\n}\n\nvar options = {}\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = require(\"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\")(content, options);\n\nif (content.locals) {\n  module.exports = content.locals;\n}\n","exports = module.exports = require(\"../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/*\\r\\nThis should be kept minimal and only provide globals\\r\\nor non-react component styles.\\r\\n*/\\r\\n\\r\\nhtml, body, #root {\\r\\n  width: 100%;\\r\\n  height: 100%;\\r\\n  margin: 0;\\r\\n}\", \"\"]);\n","import * as React from \"react\";\r\n\r\nimport ThemeProvider from \"@/theme/components/ThemeProvider\";\r\nimport StoreProvider from \"@/store/components/StoreProvider\";\r\n\r\nimport App from \"@/components/App\";\r\n\r\nconst Root: React.FC = () => (\r\n  <ThemeProvider>\r\n    <StoreProvider>\r\n      <App />\r\n    </StoreProvider>\r\n  </ThemeProvider>\r\n);\r\n\r\nexport default Root;\r\n","import * as React from \"react\";\r\n\r\nimport { ThemeProvider as JssProvider } from \"react-jss\";\r\n\r\nimport theme from \"../theme\";\r\n\r\nconst ThemeProvider: React.FC = ({ children }) => (\r\n  <JssProvider theme={theme}>\r\n    <>{children}</>\r\n  </JssProvider>\r\n);\r\n\r\nexport default ThemeProvider;\r\n","import * as React from \"react\";\r\n\r\nimport { Provider } from \"react-redux\";\r\n\r\nimport store from \"../store\";\r\n\r\nconst StoreProvider: React.FC = ({ children }) => (\r\n  <Provider store={store}>{children}</Provider>\r\n);\r\nexport default StoreProvider;\r\n","import {\r\n  compose,\r\n  createStore as createReduxStore,\r\n  applyMiddleware\r\n} from \"redux\";\r\n\r\nimport createSagaMiddleware from \"redux-saga\";\r\n\r\nimport reducer from \"./reducer\";\r\nimport saga from \"./saga\";\r\n\r\nimport {\r\n  actionSanitizer,\r\n  stateSanitizer,\r\n  actionsBlacklist\r\n} from \"./devtool-sanitizer\";\r\n\r\nfunction createStore() {\r\n  const composeEnhancers =\r\n    (window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ &&\r\n      window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({\r\n        actionSanitizer,\r\n        stateSanitizer,\r\n        actionsBlacklist\r\n      })) ||\r\n    compose;\r\n\r\n  const sagaMiddleware = createSagaMiddleware();\r\n\r\n  const store = createReduxStore(\r\n    reducer,\r\n    composeEnhancers(applyMiddleware(sagaMiddleware))\r\n  );\r\n  sagaMiddleware.run(saga);\r\n  return store;\r\n}\r\n\r\nconst store = createStore();\r\nexport default store;\r\n","import { combineReducers, AnyAction, Reducer } from \"redux\";\r\n\r\nimport { AppState, defaultAppState } from \"@/state\";\r\nimport gameReducer from \"@/services/game/reducer\";\r\nimport { GameState } from \"@/services/game/state\";\r\n\r\nconst servicesReducer = combineReducers({\r\n  // reduce-reducer types are not aligning with redux types\r\n  game: gameReducer as Reducer<GameState>\r\n});\r\n\r\nexport default function reducer(\r\n  state: AppState = defaultAppState,\r\n  action: AnyAction\r\n): AppState {\r\n  return {\r\n    services: servicesReducer(state.services, action)\r\n  };\r\n}\r\n","import { GameState, defaultGameState } from \"./services/game/state\";\r\n\r\nexport interface AppState {\r\n  services: {\r\n    game: GameState;\r\n  };\r\n}\r\n\r\nexport const defaultAppState: Readonly<AppState> = Object.freeze({\r\n  services: {\r\n    game: defaultGameState\r\n  }\r\n});\r\n\r\nexport type AppSelector<T = any> = (state: Readonly<AppState>) => T;\r\n","import reduceReducers from \"reduce-reducers\";\r\n\r\nimport { GameState } from \"../state\";\r\n\r\nimport placeTokenReducer from \"./place-token\";\r\nimport resetReducer from \"./reset\";\r\nimport startGameReducer from \"./start-game\";\r\n\r\nconst gameReducer = reduceReducers<GameState>(\r\n  placeTokenReducer,\r\n  resetReducer,\r\n  startGameReducer\r\n);\r\nexport default gameReducer;\r\n","import { AnyAction } from \"redux\";\r\nimport { find, shuffle, range } from \"lodash\";\r\nimport { set as setFp } from \"lodash/fp\";\r\n\r\nimport { isNotNull } from \"@/utils\";\r\n\r\nimport { GameState, defaultGameState } from \"../state\";\r\nimport { isPlaceTokenAction } from \"../actions/place-token\";\r\nimport { winningPositions, winningToken } from \"../selectors\";\r\nimport { AI_TOKEN } from \"../consts\";\r\nimport { TokenType, WinLine, TokensArray } from \"../types\";\r\nimport winLines from \"../win-lines\";\r\nimport { performAiMove } from \"./ai-move\";\r\n\r\nexport default function placeTokenReducer(\r\n  state: GameState = defaultGameState,\r\n  action: AnyAction\r\n): GameState {\r\n  if (!isPlaceTokenAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  // Dont place a token if someone already won.\r\n  if (winningPositions.local(state)) {\r\n    return state;\r\n  }\r\n\r\n  const { position } = action.payload;\r\n\r\n  if (state.tokens[position] !== \"blank\") {\r\n    return state;\r\n  }\r\n\r\n  state = {\r\n    ...state,\r\n    tokens: setFp([position], state.turn, state.tokens),\r\n    turn: state.turn === \"x\" ? \"o\" : \"x\"\r\n  };\r\n\r\n  if (\r\n    state.mode === \"ai\" &&\r\n    state.turn === AI_TOKEN &&\r\n    winningToken.local(state) == null\r\n  ) {\r\n    state = performAiMove(state);\r\n    state = {\r\n      ...state,\r\n      turn: state.turn === \"x\" ? \"o\" : \"x\"\r\n    };\r\n  }\r\n\r\n  return state;\r\n}\r\n","export function windowArray<T>(array: T[], count: number): T[][] {\r\n  const a = [...array];\r\n\r\n  let result: T[][] = [];\r\n  let window: T[] = [];\r\n\r\n  while (a.length > 0) {\r\n    window.push(a.pop()!);\r\n    if (window.length === count) {\r\n      result.push(window);\r\n      window = [];\r\n    }\r\n  }\r\n\r\n  if (window.length > 0) {\r\n    result.push(window);\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nexport function isNotNull<T>(x: T | null | undefined): x is T {\r\n  return x != null;\r\n}\r\n","import { GameState, defaultGameState } from \"../state\";\r\nimport { AnyAction } from \"redux\";\r\nimport { isResetAction } from \"@/services/game/actions/reset\";\r\nimport { performAiMove } from \"./ai-move\";\r\n\r\nexport default function resetReducer(\r\n  state: GameState = defaultGameState,\r\n  action: AnyAction\r\n): GameState {\r\n  if (!isResetAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  state = {\r\n    ...defaultGameState,\r\n    mode: state.mode\r\n  };\r\n\r\n  if (state.mode === \"ai\") {\r\n    state = performAiMove(state);\r\n  }\r\n\r\n  return state;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { GameState } from \"../state\";\r\nimport { isStartGameAction } from \"../actions/start-game\";\r\nimport { performAiMove } from \"./ai-move\";\r\n\r\nexport default function startGameReducer(\r\n  state: GameState,\r\n  action: AnyAction\r\n): GameState {\r\n  if (!isStartGameAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { mode } = action.payload;\r\n\r\n  // AI goes first\r\n  if (mode === \"ai\") {\r\n    state = performAiMove(state);\r\n  }\r\n\r\n  return {\r\n    ...state,\r\n    mode\r\n  };\r\n}\r\n","import { fork } from \"redux-saga/effects\";\r\n\r\nexport default function* rootSaga(): IterableIterator<any> {}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { AppState } from \"@/state\";\r\n\r\nexport const actionsBlacklist: string[] = [];\r\n\r\nexport function actionSanitizer(action: AnyAction): AnyAction {\r\n  return action;\r\n}\r\n\r\nexport function stateSanitizer(state: AppState): any {\r\n  return state;\r\n}\r\n","import * as React from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\n\r\nimport { modeSelector } from \"@/services/game/selectors\";\r\n\r\nimport Game from \"./Game\";\r\nimport ModeSelect from \"./ModeSelect\";\r\n\r\nconst App: React.FC = () => {\r\n  const mode = useSelector(modeSelector);\r\n  if (mode == null) {\r\n    return <ModeSelect />;\r\n  }\r\n  return <Game />;\r\n};\r\n\r\nexport default App;\r\n","import * as React from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { range } from \"lodash\";\r\n\r\nimport { GRIDS } from \"@/services/game/consts\";\r\nimport { turnSelector } from \"@/services/game/selectors\";\r\n\r\nimport theme from \"@/theme/theme\";\r\n\r\nimport Field from \"./Field\";\r\nimport Grid from \"./Grid\";\r\nimport ResetButton from \"./ResetButton\";\r\n\r\nconst Game: React.FC = () => {\r\n  const turn = useSelector(turnSelector);\r\n  return (\r\n    <div>\r\n      <Field>\r\n        {range(0, GRIDS).map(gridIndex => {\r\n          const x = gridIndex % 3;\r\n          const y = Math.floor(gridIndex / 3);\r\n          return (\r\n            <Grid\r\n              key={gridIndex}\r\n              gridIndex={gridIndex}\r\n              x={theme.gridSizePx * x + 20}\r\n              y={theme.gridSizePx * y + 20}\r\n            />\r\n          );\r\n        })}\r\n      </Field>\r\n      <div>Turn: {turn}</div>\r\n      <ResetButton />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Game;\r\n","import * as React from \"react\";\r\n\r\nimport theme from \"@/theme/theme\";\r\n\r\nconst Field: React.FC = ({ children }) => {\r\n  return (\r\n    <svg width={theme.gridSizePx * 3 + 50} height={theme.gridSizePx * 3 + 50}>\r\n      {children}\r\n    </svg>\r\n  );\r\n};\r\n\r\nexport default Field;\r\n","import * as React from \"react\";\r\nimport { range } from \"lodash\";\r\n\r\nimport { TOKENS_PER_GRID } from \"@/services/game/consts\";\r\nimport { getTokenArrayIndex } from \"@/services/game/utils\";\r\n\r\nimport GridVisual from \"./GridVisual\";\r\nimport PositionedToken from \"./PositionedToken\";\r\n\r\nexport interface GridProps {\r\n  x: number;\r\n  y: number;\r\n  gridIndex: number;\r\n}\r\n\r\nconst Grid: React.FC<GridProps> = ({ x, y, gridIndex }) => {\r\n  return (\r\n    <GridVisual x={x} y={y}>\r\n      {range(0, TOKENS_PER_GRID).map(gridTokenIndex => {\r\n        const position = getTokenArrayIndex(gridIndex, gridTokenIndex);\r\n        return <PositionedToken key={position} position={position} />;\r\n      })}\r\n    </GridVisual>\r\n  );\r\n};\r\n\r\nexport default Grid;\r\n","import * as React from \"react\";\r\n\r\nimport theme from \"@/theme/theme\";\r\n\r\nconst childOffset = (theme.squareSizePx - theme.tokenSizePx) / 2;\r\n\r\nexport interface GridProps {\r\n  x: number;\r\n  y: number;\r\n}\r\n\r\nconst GridVisual: React.FC<GridProps> = ({ x, y, children }) => {\r\n  const lineChildren: React.ReactNode[] = [];\r\n  for (let i = 1; i <= 2; i++) {\r\n    lineChildren.push(\r\n      <line\r\n        key={`x${i}`}\r\n        x1={0}\r\n        y1={theme.squareSizePx * i}\r\n        x2={theme.squareSizePx * 3}\r\n        y2={theme.squareSizePx * i}\r\n      />\r\n    );\r\n    lineChildren.push(\r\n      <line\r\n        key={`y${i}`}\r\n        y1={0}\r\n        x1={theme.squareSizePx * i}\r\n        y2={theme.squareSizePx * 3}\r\n        x2={theme.squareSizePx * i}\r\n      />\r\n    );\r\n  }\r\n\r\n  const arrayChildren = React.Children.toArray(children);\r\n  const contentChildren: React.ReactNode[] = [];\r\n  for (let i = 0; i < arrayChildren.length; i++) {\r\n    const x = i % 3;\r\n    const y = Math.floor(i / 3);\r\n    contentChildren.push(\r\n      <g\r\n        transform={`translate(${theme.squareSizePx * x +\r\n          childOffset}, ${theme.squareSizePx * y + childOffset})`}\r\n        key={`ch${i}`}\r\n      >\r\n        {arrayChildren[i]}\r\n      </g>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <g transform={`translate(${x}, ${y})`}>\r\n      <g strokeWidth={1} stroke=\"black\">\r\n        {lineChildren}\r\n      </g>\r\n      {contentChildren}\r\n    </g>\r\n  );\r\n};\r\n\r\nexport default GridVisual;\r\n","import * as React from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\n\r\nimport { AppState } from \"@/state\";\r\nimport { placeToken } from \"@/services/game/actions/place-token\";\r\nimport { winningPositions } from \"@/services/game/selectors\";\r\n\r\nimport Token from \"./Token\";\r\n\r\nconst PositionedToken: React.FC<{ position: number }> = ({ position }) => {\r\n  const dispatcher = useDispatch();\r\n  const tokenState = useSelector(\r\n    (state: AppState) => state.services.game.tokens[position]\r\n  );\r\n\r\n  let isWinning = false;\r\n  const winningPosition = useSelector(winningPositions);\r\n  if (winningPosition && winningPosition.includes(position)) {\r\n    isWinning = true;\r\n  }\r\n\r\n  const onClick = React.useCallback(() => {\r\n    dispatcher(placeToken(position));\r\n  }, [position]);\r\n\r\n  return (\r\n    <Token\r\n      isWinningToken={isWinning}\r\n      tokenType={tokenState}\r\n      onClick={onClick}\r\n    />\r\n  );\r\n};\r\n\r\nexport default PositionedToken;\r\n","import * as React from \"react\";\r\n\r\nimport theme from \"@/theme/theme\";\r\nimport { TokenType } from \"@/services/game/types\";\r\n\r\nexport interface TokenProps {\r\n  tokenType: TokenType | \"blank\";\r\n  isWinningToken: boolean;\r\n  onClick?(e: React.MouseEvent<SVGGElement>): void;\r\n}\r\n\r\ninterface TokenPartProps {\r\n  color: string;\r\n  onClick?(e: React.MouseEvent<SVGGElement>): void;\r\n}\r\n\r\nconst size = theme.tokenSizePx;\r\n\r\nconst TokenX: React.FC<TokenPartProps> = ({ onClick, color }) => (\r\n  <g strokeWidth={1} stroke={color} onClick={onClick}>\r\n    <rect strokeWidth={0} fill=\"transparent\" width={size} height={size} />\r\n    <line x1={0} y1={0} x2={size} y2={size} />\r\n    <line x1={size} y1={0} x2={0} y2={size} />\r\n  </g>\r\n);\r\nconst TokenO: React.FC<TokenPartProps> = ({ onClick, color }) => (\r\n  <g strokeWidth={1} stroke={color} fill=\"none\" onClick={onClick}>\r\n    <rect strokeWidth={0} fill=\"transparent\" width={size} height={size} />\r\n    <circle cx={size / 2} cy={size / 2} r={size / 2} />\r\n  </g>\r\n);\r\n\r\nconst TokenBlank: React.FC<TokenPartProps> = ({ onClick }) => (\r\n  <rect fill=\"transparent\" width={size} height={size} onClick={onClick} />\r\n);\r\n\r\nconst Token: React.FC<TokenProps> = ({\r\n  tokenType,\r\n  isWinningToken,\r\n  onClick\r\n}) => {\r\n  const color = isWinningToken ? \"red\" : \"black\";\r\n  switch (tokenType) {\r\n    case \"x\":\r\n      return <TokenX color={color} onClick={onClick} />;\r\n    case \"o\":\r\n      return <TokenO color={color} onClick={onClick} />;\r\n    case \"blank\":\r\n      return <TokenBlank color=\"transparent\" onClick={onClick} />;\r\n    default:\r\n      return <div>Error</div>;\r\n  }\r\n};\r\n\r\nexport default Token;\r\n","import * as React from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\n\r\nimport { reset } from \"@/services/game/actions/reset\";\r\n\r\nconst ResetButton: React.FC = () => {\r\n  const dispatch = useDispatch();\r\n  const onClick = React.useCallback(() => {\r\n    dispatch(reset());\r\n  }, [dispatch]);\r\n\r\n  return <button onClick={onClick}>Reset</button>;\r\n};\r\n\r\nexport default ResetButton;\r\n","import * as React from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { startGame } from \"@/services/game/actions/start-game\";\r\n\r\nconst ModeSelect: React.FC = () => {\r\n  const dispatch = useDispatch();\r\n  const onLocal = React.useCallback(() => {\r\n    dispatch(startGame(\"local\"));\r\n  }, [dispatch]);\r\n  const onAI = React.useCallback(() => {\r\n    dispatch(startGame(\"ai\"));\r\n  }, [dispatch]);\r\n  return (\r\n    <div>\r\n      <button onClick={onLocal}>Local 2 player</button>\r\n      <button onClick={onAI}>VS AI</button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ModeSelect;\r\n"],"sourceRoot":""}